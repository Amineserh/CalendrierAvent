<Window x:Class="CalendrierAvent.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Calendrier de l'Avent"
        WindowStartupLocation="CenterScreen"
        ResizeMode="NoResize"
        Width="1280" Height="720"
        Background="#000000"
        Loaded="Window_Loaded">

    <!-- 🎬 ANIMATIONS -->
    <Window.Resources>

        <!-- Animation d'apparition du titre + date : fondu + léger zoom -->
        <Storyboard x:Key="TitleAppearStoryboard">
            <!-- Opacité -->
            <DoubleAnimation Storyboard.TargetName="TitlePanel"
                             Storyboard.TargetProperty="Opacity"
                             From="0" To="1"
                             Duration="0:0:1.2">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>

            <!-- Zoom X -->
            <DoubleAnimation Storyboard.TargetName="TitleScale"
                             Storyboard.TargetProperty="ScaleX"
                             From="0.9" To="1"
                             Duration="0:0:1.2">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>

            <!-- Zoom Y -->
            <DoubleAnimation Storyboard.TargetName="TitleScale"
                             Storyboard.TargetProperty="ScaleY"
                             From="0.9" To="1"
                             Duration="0:0:1.2">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>

        <!-- Animation d'apparition du calendrier de l'Avent -->
        <Storyboard x:Key="CalendarAppearStoryboard">
            <DoubleAnimation Storyboard.TargetName="CalendarOverlay"
                             Storyboard.TargetProperty="Opacity"
                             From="0" To="1"
                             Duration="0:0:0.6">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>

            <DoubleAnimation Storyboard.TargetName="CalendarScale"
                             Storyboard.TargetProperty="ScaleX"
                             From="0.6" To="1"
                             Duration="0:0:0.6">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>

            <DoubleAnimation Storyboard.TargetName="CalendarScale"
                             Storyboard.TargetProperty="ScaleY"
                             From="0.6" To="1"
                             Duration="0:0:0.6">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>

    </Window.Resources>

    <Grid Background="#000000">

        <!-- ========= ÉCRAN VIDÉO ========= -->
        <Grid x:Name="IntroGrid">
            <MediaElement x:Name="IntroVideo"
                          HorizontalAlignment="Stretch"
                          VerticalAlignment="Stretch"
                          Margin="40"
                          Stretch="UniformToFill"
                          LoadedBehavior="Manual"
                          UnloadedBehavior="Stop"
                          MediaFailed="IntroVideo_MediaFailed"
                          MediaEnded="IntroVideo_MediaEnded" />

            <!-- BOUTON SKIP (ouvre la popup pour le prénom) -->
            <Border HorizontalAlignment="Right"
                    VerticalAlignment="Top"
                    Margin="0,20,20,0"
                    Background="#AA000000"
                    Padding="0">
                <Button x:Name="SkipButton"
                        Content="Skip"
                        Width="120"
                        Height="45"
                        Background="Transparent"
                        Foreground="White"
                        FontSize="18"
                        BorderThickness="0"
                        Opacity="0.85"
                        Click="SkipButton_Click" />
            </Border>

            <!-- POPUP DEMANDE DE PRÉNOM -->
            <Grid x:Name="NamePopup"
                  Background="#80000000"
                  Visibility="Collapsed">
                <Border Background="White"
                        Padding="20"
                        Width="450"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center">
                    <StackPanel>
                        <TextBlock Text="Ho ho ho... qui est là ?"
                                   FontSize="26"
                                   FontWeight="Bold"
                                   Margin="0,0,0,10"
                                   TextAlignment="Center" />
                        <TextBlock Text="Entre ton prénom pour continuer ✨"
                                   FontSize="16"
                                   Margin="0,0,0,15"
                                   TextAlignment="Center" />
                        <TextBox x:Name="NameTextBox"
                                 FontSize="18"
                                 Margin="0,0,0,15"
                                 HorizontalAlignment="Stretch" />
                        <Button Content="Valider"
                                Width="130"
                                Height="40"
                                HorizontalAlignment="Center"
                                Background="#CC1A1A"
                                Foreground="White"
                                FontSize="18"
                                BorderThickness="0"
                                Click="ConfirmNameButton_Click" />
                    </StackPanel>
                </Border>
            </Grid>
        </Grid>

        <!-- ========= ÉCRAN PORTE ========= -->
        <Grid x:Name="DoorGrid"
              Visibility="Collapsed">
            <!-- Image de la porte -->
            <Image x:Name="DoorImage"
                   HorizontalAlignment="Stretch"
                   VerticalAlignment="Stretch"
                   Stretch="UniformToFill" />
            <!-- Bouton pour entrer (plein centre, invisible) -->
            <Button x:Name="EnterButton"
                    Content="Entrer"
                    Width="2000"
                    Height="600"
                    FontSize="24"
                    FontWeight="Bold"
                    BorderThickness="0"
                    Opacity="0"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Click="EnterButton_Click" />
        </Grid>

        <!-- ========= SECONDE PAGE (NOUVELLE VIDÉO) ========= -->
        <Grid x:Name="NextPageGrid"
              Background="Black"
              Visibility="Collapsed">

            <!-- Vidéo de fond -->
            <MediaElement x:Name="NextVideo"
                          HorizontalAlignment="Stretch"
                          VerticalAlignment="Stretch"
                          Stretch="UniformToFill"
                          LoadedBehavior="Manual"
                          UnloadedBehavior="Stop" />

            <!-- Texte fallback si pas de vidéo -->
            <TextBlock x:Name="NextPageText"
                       Text="Nouvelle page en préparation..."
                       Foreground="White"
                       FontSize="32"
                       FontWeight="Bold"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center"
                       TextAlignment="Center"
                       Opacity="0.7" />

            <!-- ZONE CLIQUABLE SAPIN (invisible, décalée à ~25% de l'écran) -->
            <Button x:Name="TreeButton"
                    Width="220"
                    Height="500"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Center"
                    Margin="320,0,0,0"
                    Background="Transparent"
                    BorderThickness="0"
                    Opacity="0"
                    Focusable="False"
                    Click="TreeButton_Click">
                <Button.Template>
                    <ControlTemplate TargetType="Button">
                        <Border Background="Transparent">
                            <ContentPresenter />
                        </Border>
                    </ControlTemplate>
                </Button.Template>
            </Button>

            <!-- OVERLAY CALENDRIER DE L'AVENT -->
            <Grid x:Name="CalendarOverlay"
                  Background="#80000000"
                  Visibility="Collapsed"
                  Opacity="0">
                <Border x:Name="CalendarContainer"
                        Background="#FF1E1E1E"
                        CornerRadius="12"
                        Padding="20"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        RenderTransformOrigin="0.5,0.5">
                    <Border.RenderTransform>
                        <ScaleTransform x:Name="CalendarScale"
                                        ScaleX="0.6"
                                        ScaleY="0.6" />
                    </Border.RenderTransform>

                    <StackPanel>
                        <TextBlock Text="Calendrier de l'Avent"
                                   FontSize="30"
                                   FontWeight="Bold"
                                   Foreground="#FFFFD54F"
                                   TextAlignment="Center"
                                   Margin="0,0,0,10" />

                        <UniformGrid x:Name="CalendarGrid"
                                     Rows="4"
                                     Columns="6"
                                     Margin="10">

                            <!-- 24 cases (1 à 24) -->
                            <Button Content="1"  Margin="5" FontSize="20" FontWeight="Bold" Click="DayButton_Click"/>
                            <Button Content="2"  Margin="5" FontSize="20" FontWeight="Bold" Click="DayButton_Click"/>
                            <Button Content="3"  Margin="5" FontSize="20" FontWeight="Bold" Click="DayButton_Click"/>
                            <Button Content="4"  Margin="5" FontSize="20" FontWeight="Bold" Click="DayButton_Click"/>
                            <Button Content="5"  Margin="5" FontSize="20" FontWeight="Bold" Click="DayButton_Click"/>
                            <Button Content="6"  Margin="5" FontSize="20" FontWeight="Bold" Click="DayButton_Click"/>
                            <Button Content="7"  Margin="5" FontSize="20" FontWeight="Bold" Click="DayButton_Click"/>
                            <Button Content="8"  Margin="5" FontSize="20" FontWeight="Bold" Click="DayButton_Click"/>
                            <Button Content="9"  Margin="5" FontSize="20" FontWeight="Bold" Click="DayButton_Click"/>
                            <Button Content="10" Margin="5" FontSize="20" FontWeight="Bold" Click="DayButton_Click"/>
                            <Button Content="11" Margin="5" FontSize="20" FontWeight="Bold" Click="DayButton_Click"/>
                            <Button Content="12" Margin="5" FontSize="20" FontWeight="Bold" Click="DayButton_Click"/>
                            <Button Content="13" Margin="5" FontSize="20" FontWeight="Bold" Click="DayButton_Click"/>
                            <Button Content="14" Margin="5" FontSize="20" FontWeight="Bold" Click="DayButton_Click"/>
                            <Button Content="15" Margin="5" FontSize="20" FontWeight="Bold" Click="DayButton_Click"/>
                            <Button Content="16" Margin="5" FontSize="20" FontWeight="Bold" Click="DayButton_Click"/>
                            <Button Content="17" Margin="5" FontSize="20" FontWeight="Bold" Click="DayButton_Click"/>
                            <Button Content="18" Margin="5" FontSize="20" FontWeight="Bold" Click="DayButton_Click"/>
                            <Button Content="19" Margin="5" FontSize="20" FontWeight="Bold" Click="DayButton_Click"/>
                            <Button Content="20" Margin="5" FontSize="20" FontWeight="Bold" Click="DayButton_Click"/>
                            <Button Content="21" Margin="5" FontSize="20" FontWeight="Bold" Click="DayButton_Click"/>
                            <Button Content="22" Margin="5" FontSize="20" FontWeight="Bold" Click="DayButton_Click"/>
                            <Button Content="23" Margin="5" FontSize="20" FontWeight="Bold" Click="DayButton_Click"/>
                            <Button Content="24" Margin="5" FontSize="20" FontWeight="Bold" Click="DayButton_Click"/>

                        </UniformGrid>
                    </StackPanel>
                </Border>
            </Grid>

            <!-- POPUP CADEAU (image + texte) -->
            <Grid x:Name="GiftPopup"
                  Background="#CC000000"
                  Visibility="Collapsed">
                <Border Background="#FF2C2C2C"
                        CornerRadius="16"
                        Padding="20"
                        Width="600"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <TextBlock x:Name="GiftTitleText"
                                   Text="Cadeau du jour"
                                   FontSize="26"
                                   FontWeight="Bold"
                                   Foreground="#FFFFD54F"
                                   TextAlignment="Center"
                                   Margin="0,0,0,10"/>

                        <StackPanel Grid.Row="1">
                            <Image x:Name="GiftImage"
                                   Height="260"
                                   Stretch="Uniform"
                                   Margin="0,0,0,10"/>
                            <TextBlock x:Name="GiftMessageText"
                                       Text=""
                                       FontSize="18"
                                       Foreground="White"
                                       TextWrapping="Wrap"
                                       TextAlignment="Center"
                                       Margin="10,0,10,0"/>
                        </StackPanel>

                        <Button Grid.Row="2"
                                Content="Fermer"
                                Width="120"
                                Height="38"
                                HorizontalAlignment="Center"
                                Margin="0,15,0,0"
                                Background="#CC1A1A"
                                Foreground="White"
                                FontWeight="Bold"
                                BorderThickness="0"
                                Click="CloseGiftPopupButton_Click"/>
                    </Grid>
                </Border>
            </Grid>

        </Grid>

        <!-- ========= TITRE + DATE (PAR-DESSUS TOUT) ========= -->
        <StackPanel x:Name="TitlePanel"
                    VerticalAlignment="Top"
                    HorizontalAlignment="Center"
                    Margin="0,20,0,0"
                    Opacity="0"
                    RenderTransformOrigin="0.5,0.5">
            <StackPanel.RenderTransform>
                <ScaleTransform x:Name="TitleScale" ScaleX="0.9" ScaleY="0.9"/>
            </StackPanel.RenderTransform>

            <TextBlock x:Name="TitleText"
                       Text=""
                       FontSize="50"
                       FontWeight="Bold"
                       Foreground="#FFE53935"
                       TextAlignment="Center"
                       FontFamily="Segoe UI Black">
                <TextBlock.Effect>
                    <DropShadowEffect Color="Black"
                                      BlurRadius="10"
                                      ShadowDepth="0"
                                      Opacity="0.7"/>
                </TextBlock.Effect>
            </TextBlock>

            <TextBlock x:Name="DateText"
                       Margin="0,10,0,0"
                       Text=""
                       FontSize="28"
                       FontWeight="SemiBold"
                       Foreground="#FFFFD54F"
                       TextAlignment="Center"
                       FontFamily="Segoe UI Semibold">
                <TextBlock.Effect>
                    <DropShadowEffect Color="Black"
                                      BlurRadius="6"
                                      ShadowDepth="0"
                                      Opacity="0.6"/>
                </TextBlock.Effect>
            </TextBlock>
        </StackPanel>

    </Grid>
</Window>